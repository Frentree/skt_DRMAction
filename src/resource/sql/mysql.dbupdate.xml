<?xml version="1.0" encoding="EUC-KR"?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"  "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="update">
	<update id="setDelDate" parameterClass="com.skyun.recon.util.database.ibatis.vo.pathVo">
		UPDATE pi_find
			SET DELDATE = NULL
		WHERE TARGET_ID = (SELECT TARGET_ID FROM pi_targets WHERE NAME = #hostname#)
		AND AP_NO IN (1, 2)
		AND REPLACE(PATH, '_decrypted.', '.') = #path#
		AND REGDATE = (SELECT MAX(REGDATE) 
							FROM pi_find
							WHERE TARGET_ID = (SELECT TARGET_ID FROM pi_targets WHERE NAME = #hostname#)
							AND REPLACE(PATH, '_decrypted.', '.') = #path# )
	</update>
	
</sqlMap>
